"use strict";(self["webpackChunkweek6and7"]=self["webpackChunkweek6and7"]||[]).push([[198],{8006:function(e,t,o){o.d(t,{Z:function(){return g}});var a=o(6252),n=o(3577),l=o(9963);const s={"aria-label":"Page navigation example"},i={class:"pagination justify-content-center"},d=(0,a._)("span",{"aria-hidden":"true"},"«",-1),p=[d],u=["onClick"],c=(0,a._)("span",{"aria-hidden":"true"},"»",-1),r=[c];function m(e,t,o,d,c,m){return(0,a.wg)(),(0,a.iD)("nav",s,[(0,a._)("ul",i,[(0,a._)("li",{class:(0,n.C_)(["page-item",{disabled:!o.pagination.has_pre}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Previous",onClick:t[0]||(t[0]=(0,l.iM)((t=>e.$emit("getData",o.pagination.current_page-1)),["prevent"]))},p)],2),((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(o.pagination.total_pages,(t=>((0,a.wg)(),(0,a.iD)("li",{class:(0,n.C_)(["page-item",{active:o.pagination.current_page===t}]),key:t+"page"},[(0,a._)("a",{class:"page-link",href:"#",onClick:(0,l.iM)((o=>e.$emit("getData",t)),["prevent"])},(0,n.zw)(t),9,u)],2)))),128)),(0,a._)("li",{class:(0,n.C_)(["page-item",{disabled:!o.pagination.has_next}])},[(0,a._)("a",{class:"page-link",href:"#","aria-label":"Next",onClick:t[1]||(t[1]=(0,l.iM)((t=>e.$emit("getData",o.pagination.current_page+1)),["prevent"]))},r)],2)])])}var _={props:["pagination"]},h=o(3744);const b=(0,h.Z)(_,[["render",m]]);var g=b},7903:function(e,t,o){o.d(t,{Z:function(){return s}});var a=o(7244),n={data(){return{modal:""}},methods:{openModal(){this.modal.show()},hideModal(){this.modal.hide()}},mounted(){this.modal=new a.u_(this.$refs.modal)}};const l=n;var s=l},198:function(e,t,o){o.r(t),o.d(t,{default:function(){return ne}});var a=o(6252),n=o(3577);const l={class:"container"},s={class:"text-end mt-4"},i={class:"table mt-4"},d=(0,a._)("thead",null,[(0,a._)("tr",null,[(0,a._)("th",null,"名稱"),(0,a._)("th",null,"折扣百分比"),(0,a._)("th",null,"到期日"),(0,a._)("th",null,"是否啟用"),(0,a._)("th",null,"編輯")])],-1),p={class:"btn-group"},u=["onClick"],c=["onClick"];function r(e,t,o,r,m,_){const h=(0,a.up)("IsLoading"),b=(0,a.up)("CouponModal"),g=(0,a.up)("delCouponModal"),C=(0,a.up)("PaginationComponent");return(0,a.wg)(),(0,a.iD)(a.HY,null,[(0,a.Wm)(h,{style:{"z-index":"1000"},active:m.isLoading},null,8,["active"]),(0,a._)("div",l,[(0,a._)("div",s,[(0,a._)("button",{class:"btn btn-primary",onClick:t[0]||(t[0]=e=>_.openModal("new"))}," 建立新的折扣券 ")]),(0,a._)("table",i,[d,(0,a._)("tbody",null,[((0,a.wg)(!0),(0,a.iD)(a.HY,null,(0,a.Ko)(m.coupons,(e=>((0,a.wg)(),(0,a.iD)("tr",{key:e.id},[(0,a._)("td",null,(0,n.zw)(e.code),1),(0,a._)("td",null,(0,n.zw)(e.percent)+"%",1),(0,a._)("td",null,(0,n.zw)(new Date(1e3*e.due_date).toLocaleDateString()),1),(0,a._)("td",null,[(0,a._)("span",{class:(0,n.C_)({"text-success":e.is_enabled,"text-danger":!e.is_enabled})},(0,n.zw)(e.is_enabled?"啟用":"未啟用"),3)]),(0,a._)("td",null,[(0,a._)("div",p,[(0,a._)("button",{type:"button",class:"btn btn-outline-primary btn-sm",onClick:t=>_.openModal("edit",e)}," 編輯 ",8,u),(0,a._)("button",{type:"button",class:"btn btn-outline-danger btn-sm",onClick:t=>_.openModal("del",e)}," 刪除 ",8,c)])])])))),128))])])]),(0,a.Wm)(b,{coupons:m.tempCoupons,onUpdateCoupon:_.updateCoupon,isNew:m.isNew,"temp-coupons":m.tempCoupons,ref:"CouponModal"},null,8,["coupons","onUpdateCoupon","isNew","temp-coupons"]),(0,a.Wm)(g,{"temp-coupons":m.tempCoupons,ref:"delCouponModal"},null,8,["temp-coupons"]),(0,a.Wm)(C,{pagination:m.pagination,onGetData:_.getData},null,8,["pagination","onGetData"])],64)}var m=o(9963);const _={class:"modal fade",id:"couponModal",tabindex:"-1",role:"dialog","aria-labelledby":"exampleModalLabel","aria-hidden":"true",ref:"modal"},h={class:"modal-dialog",role:"document"},b={class:"modal-content"},g={class:"modal-header"},C={class:"modal-title",id:"exampleModalLabel"},v={key:0},f={key:1},w=(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"},null,-1),y={class:"modal-body"},M={class:"mb-3"},k=(0,a._)("label",{for:"title"},"標題",-1),D={class:"mb-3"},x=(0,a._)("label",{for:"coupon_code"},"優惠碼",-1),$={class:"mb-3"},N={for:"due_date"},L={class:"mb-3"},S=(0,a._)("label",{for:"price"},"折扣百分比",-1),z={class:"mb-3"},U={class:"form-check"},Z=(0,a._)("label",{class:"form-check-label",for:"is_enabled"}," 是否啟用 ",-1),P={class:"modal-footer"},O=(0,a._)("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function V(e,t,o,l,s,i){return(0,a.wg)(),(0,a.iD)("div",_,[(0,a._)("div",h,[(0,a._)("div",b,[(0,a._)("div",g,[(0,a._)("h5",C,[o.isNew?((0,a.wg)(),(0,a.iD)("span",v,"新增優惠卷")):((0,a.wg)(),(0,a.iD)("span",f,"編輯優惠卷"))]),w]),(0,a._)("div",y,[(0,a._)("div",M,[k,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"title",placeholder:"請輸入標題","onUpdate:modelValue":t[0]||(t[0]=t=>e.tempCoupons.title=t)},null,512),[[m.nr,e.tempCoupons.title]])]),(0,a._)("div",D,[x,(0,a.wy)((0,a._)("input",{type:"text",class:"form-control",id:"coupon_code",placeholder:"請輸入優惠碼","onUpdate:modelValue":t[1]||(t[1]=t=>e.tempCoupons.code=t)},null,512),[[m.nr,e.tempCoupons.code]])]),(0,a._)("div",$,[(0,a._)("label",N,"到期日"+(0,n.zw)(s.due_date),1),(0,a.wy)((0,a._)("input",{type:"date",class:"form-control",id:"due_date","onUpdate:modelValue":t[2]||(t[2]=e=>s.due_date=e)},null,512),[[m.nr,s.due_date]])]),(0,a._)("div",L,[S,(0,a.wy)((0,a._)("input",{type:"number",class:"form-control",id:"price",min:"0",placeholder:"請輸入折扣百分比","onUpdate:modelValue":t[3]||(t[3]=t=>e.tempCoupons.percent=t)},null,512),[[m.nr,e.tempCoupons.percent,void 0,{number:!0}]])]),(0,a._)("div",z,[(0,a._)("div",U,[(0,a.wy)((0,a._)("input",{class:"form-check-input",type:"checkbox","true-value":1,"false-value":0,id:"is_enabled","onUpdate:modelValue":t[4]||(t[4]=t=>e.tempCoupons.is_enabled=t)},null,512),[[m.e8,e.tempCoupons.is_enabled]]),Z])])]),(0,a._)("div",P,[O,(0,a._)("button",{type:"button",class:"btn btn-primary",onClick:t[5]||(t[5]=(...e)=>i.updateCoupon&&i.updateCoupon(...e))},(0,n.zw)(o.isNew?"新增優惠卷":"更新優惠券"),1)])])])],512)}var J=o(7903),W={props:["coupons","isNew","temp-coupons"],data(){return{due_date:""}},methods:{updateCoupon(){this.$emit("update-coupon",this.tempCoupons)}},watch:{tempCoupons(){const e=new Date(1e3*this.tempCoupons.due_date),t=e.getFullYear();let o=e.getMonth()+1;1===o.toString().length&&(o="0"+o);let a=e.getDate();1===a.toString().length&&(a="0"+a),this.due_date=`${t}-${o}-${a}`},due_date(){this.tempCoupons.due_date=Math.floor(new Date(this.due_date)/1e3)}},mixins:[J.Z]},Y=o(3744);const H=(0,Y.Z)(W,[["render",V]]);var I=H;const G={id:"delProductModal",ref:"modal",class:"modal fade",tabindex:"-1","aria-labelledby":"delProductModalLabel","aria-hidden":"true"},K={class:"modal-dialog"},j={class:"modal-content border-0"},F=(0,a._)("div",{class:"modal-header bg-danger text-white"},[(0,a._)("h5",{id:"delProductModalLabel",class:"modal-title"},[(0,a._)("span",null,"刪除優惠券")]),(0,a._)("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),q={class:"modal-body"},A=(0,a.Uk)(" 是否刪除 "),B=(0,a._)("strong",{class:"text-danger"},null,-1),E={class:"modal-footer"},Q=(0,a._)("button",{type:"button",class:"btn btn-outline-secondary","data-bs-dismiss":"modal"}," 取消 ",-1);function R(e,t,o,l,s,i){return(0,a.wg)(),(0,a.iD)("div",G,[(0,a._)("div",K,[(0,a._)("div",j,[F,(0,a._)("div",q,[A,B,(0,a.Uk)(" "+(0,n.zw)()+"(刪除後將無法恢復)。 ",1)]),(0,a._)("div",E,[Q,(0,a._)("button",{type:"button",class:"btn btn-danger",onClick:t[0]||(t[0]=t=>e.delOrder())}," 確認刪除 ")])])])],512)}var T={mixins:[J.Z]};const X=(0,Y.Z)(T,[["render",R]]);var ee=X,te=o(8006),oe={data(){return{coupons:[],tempCoupons:{},couponId:"",isNew:"",isLoading:!1,pagination:{}}},components:{CouponModal:I,delCouponModal:ee,PaginationComponent:te.Z},methods:{getData(e=1){this.isLoading=!0;const t=`https://vue3-course-api.hexschool.io/v2/api/mimiluckying/admin/coupons?page=${e}`;this.$http.get(t).then((e=>{this.coupons=e.data.coupons,this.pagination=e.data.pagination,this.isLoading=!1})).catch((e=>{this.isLoading=!1,this.$httpMessageState(e.response,"取得資料")}))},updateCoupon(e){this.isLoading=!0;let t="https://vue3-course-api.hexschool.io/v2/api/mimiluckying/admin/coupon",o="post";this.isNew||(t=`https://vue3-course-api.hexschool.io/v2/api/mimiluckying/admin/coupon/${e.id}`,o="put"),this.$http[o](t,{data:e}).then((e=>{this.$httpMessageState(e,"更新狀態"),this.$refs.CouponModal.hideModal(),this.getData()})).catch((e=>{this.$httpMessageState(e.response,"更新狀態"),this.isLoading=!1}))},openModal(e,t){"new"===e?(this.tempCoupons={},this.isNew=!0,this.$refs.CouponModal.openModal()):"edit"===e?(this.tempCoupons=JSON.parse(JSON.stringify(t)),this.isNew=!1,this.$refs.CouponModal.openModal(),this.couponId=t.id):"del"===e&&(this.tempCoupons=JSON.parse(JSON.stringify(t)),this.$refs.delCouponModal.openModal())}},mounted(){this.getData()}};const ae=(0,Y.Z)(oe,[["render",r]]);var ne=ae}}]);
//# sourceMappingURL=198.f109dc6b.js.map